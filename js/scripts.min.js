var Data={sources:["http://localhost:8888/fredcave/projects/the-electronic-cottage/","http://localhost:8888/fredcave/projects/dogwood-ii/","http://localhost:8888/fredcave/projects/once-removed/","http://localhost:8888/fredcave/projects/night-light/","http://localhost:8888/fredcave/projects/all-that-is-solid/","http://localhost:8888/fredcave/projects/the-wake-of-dust/","http://localhost:8888/fredcave/projects/eden-book/"],nextSrc:0,nextLayer:1,hyperLinkVisible:!1,sidebarText:!1,currentTextBlock:0},Page={init:function(){console.log("Page.init"),this.bindEvents(),this.srcInit(),this.nextLayerInit()},bindEvents:function(){console.log("Page.bindEvents"),$("#hyperlink").on("mouseover",function(){Page.nextFadeIn()}).on("mouseout",function(){Page.nextFadeOut()}).on("click",function(){Page.layerLoad()}),$("#close_button").on("click",function(){Page.infoReset()}),$("#squiggle").on("click",function(){Page.sidebarToggle()})},srcInit:function(){console.log("Page.srcInit");for(var a=Data.sources,b=a.length-1;b>0;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}},infoReset:function(){console.log("Page.infoReset"),$("#home_wrapper").fadeIn(1e3),$("#close_button").fadeOut(1e3),$(".layer").css({opacity:0})},nextLayerInit:function(){console.log("Page.nextLayerInit");var a=Data.nextSrc;nextSrc=Data.sources[a],a===Data.sources.length?Data.nextSrc=0:Data.nextSrc++,console.log(50,nextSrc,Data.nextSrc);var b=Data.nextLayer,c=$(".layer").eq(b-1).find("iframe");c.attr("src",nextSrc),c.on("load",function(){console.log(120,"iframe loaded"),Page.placeHyperLink()})},placeHyperLink:function(){console.log("Page.placeHyperLink"),Data.hyperLinkVisible||this.placeHyperLinkFirstTime()},placeHyperLinkFirstTime:function(){console.log("Page.placeHyperLinkFirstTime");var a,b,c=2*Math.random()*1e3+2e3,d=[["top_left","top","left"],["top_right","top","right"],["bottom_right","bottom","right"],["bottom_left","bottom","left"]],e=Math.ceil(4*Math.random())-1,f=Math.floor(2*Math.random())+1,g=3-f,h="50px",i=Math.random()*$(window).height()*.8;switch($("#hyperlink").addClass(d[e][0]),e){case 0:a=d[e][f],b=d[e][g];break;case 1:a=d[e][f],b=d[e][g];break;case 2:a=d[e][f],b=d[e][g];break;case 3:a=d[e][f],b=d[e][g]}setTimeout(function(){$("#hyperlink").css(a,h),$("#hyperlink").css(b,i)},c)},nextFadeIn:function(){console.log("Page.nextFadeIn");var a=$(".layer").eq(Data.nextLayer-1);a.css({opacity:.5})},nextFadeOut:function(){console.log("Page.nextFadeOut");var a=$(".layer").eq(Data.nextLayer-1);a.css({opacity:""})},closeButtonCheck:function(){console.log("Page.closeButtonCheck"),$("#close_button").is(":visible")||$("#close_button").fadeIn()},layerLoad:function(){console.log("Page.layerLoad");var a=$(".layer").eq(Data.nextLayer-1);a.css({opacity:1}),Data.nextLayer=1===Data.nextLayer?2:1,this.closeButtonCheck(),$("#home_wrapper").fadeOut(1e3),this.nextLayerInit()},sidebarToggle:function(){console.log("Page.sidebarToggle"),$("#sidebar").hasClass("visible")?$("#sidebar").css({right:""}).removeClass("visible"):($("#sidebar").css({right:0}).addClass("visible"),Data.sidebarText||(this.textInit(),Data.sidebarText=!0))},textInit:function(){console.log("Page.textInit");$("#text_wrapper").append("<div class='text_block'><p class='loading'>receiving</p></div>"),setTimeout(function(){Page.conversation(narcissus,0)},2e3)},parseForBot:function(a){return console.log("Page.parseForBot"),str=a.replace(" ","+"),str},ajaxCall:function(a,b){console.log("Page.ajaxCall"),$.ajax({method:"GET",dataType:"text",url:"http://www.botlibre.com/rest/botlibre/form-chat?application=_4581146104707647883&instance=15464920&message="+Page.parseForBot(a),success:function(a){var c=$.parseXML(a),d=$(c).find("message").html();Page.responseParse(d,b)},error:function(){console.log(274,"Error receiving from server."),Page.responseParse(b[Data.currentTextBlock][1],b)},complete:function(){}})},conversation:function(a,b){if(console.log("Page.conversation"),0===Data.currentTextBlock&&setTimeout(function(){Page.hideFirstBlock()},500),console.log(Data.currentTextBlock,Object.keys(a).length),Data.currentTextBlock<Object.keys(a).length)setTimeout(function(){Page.appendWordByWord(a[Data.currentTextBlock][0],a,!1)},0);else{console.log("Print credits");var c="H. C. Andersen, M. Blanchot, J. B. van Helmont, E. Hemingway, B. Lee, H. Melville, H. J. Newell,T. Vesaas in conversation with Tarjei the bot.";Page.appendWordByWord(c,a,!1)}},heightChecker:function(){console.log("Page.heightChecker");var a=$("#sidebar").height(),b=$("#text_wrapper").height();if(b>.6*a||47===Data.currentTextBlock){console.log(331);var c=$("#text_wrapper").children().length;if(console.log(c," blocks left."),0==c)return Page.sidebarToggle(),void $("#squiggle").fadeOut(1e3);Page.hideFirstBlock(),setTimeout(function(){Page.heightChecker()},1200)}},responseParse:function(a,b){console.log("Page.responseParse");for(var c,d=a.split("."),e="",f=0;f<d.length;f++)d[f].length<=3&&(d[f]=""),""!==d[f]&&(c=d[f].trim().toLowerCase(),c=c[0].toUpperCase()+c.substring(1)+". ",e+=c);Page.appendWordByWord(e,b,!0)},appendWordByWord:function(a,b,c){console.log("Page.appendWordByWord");var d,e=Data.currentTextBlock,f=a.split(" "),g=0;c&&(e=Data.currentTextBlock+"_response"),d="<div class='text_block'><p id='"+e+"'></p></div>",$("#text_wrapper").append(d);var h=setInterval(function(){if($("#"+e).text($("#"+e).text()+" "+f[g]),g++,f.length-g<=0){if(clearInterval(h),Page.heightChecker(),Data.currentTextBlock>=Object.keys(b).length)return void Page.heightChecker();c?(Data.currentTextBlock++,Page.conversation(b,Data.currentTextBlock)):Page.ajaxCall(b[Data.currentTextBlock][0],b)}},0)},hideFirstBlock:function(){console.log("Page.hideFirstBlock");var a=$("#text_wrapper .text_block").eq(0),b=2*a.height();a.find("p").css({transform:"translateY(-"+b+"px)"}),setTimeout(function(){$("#text_wrapper .text_block").eq(0).slideUp(500),setTimeout(function(){$("#text_wrapper .text_block").eq(0).remove()},500)},500)}};$(document).ready(function(){$(window).on("load",function(){Page.init()})});